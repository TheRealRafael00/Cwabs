import base64
exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCByZQppbXBvcnQgc3lzCmltcG9ydCB0aW1lCmltcG9ydCBzb2NrZXQKaW1wb3J0IHJlcXVlc3RzCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCmZyb20gaXB3aG9pcyBpbXBvcnQgSVBXaG9pcwppbXBvcnQgcHl0egppbXBvcnQgc2lnbmFsCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aAoKIyBXYXJuYSB0ZXJtaW5hbApSRVNFVCA9ICJcMDMzWzBtIgpDWUFOID0gIlwwMzNbOTZtIgpZRUxMT1cgPSAiXDAzM1s5M20iCkdSRUVOID0gIlwwMzNbOTJtIgpSRUQgPSAiXDAzM1s5MW0iCkJPTEQgPSAiXDAzM1sxbSIKQkxVRSA9ICJcMDMzWzk0bSIKCiMgQW50aSBDdHJsK0MKZGVmIGhhbmRsZV9zaWdpbnQoc2lnLCBmcmFtZSk6CiAgICBwcmludChmIlxue1JFRH1bIV0gQ3RybCtDIGlzIGRpc2FibGVkLiBVc2UgdGhlIG1lbnUgdG8gZXhpdCBwcm9wZXJseS57UkVTRVR9IikKc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHSU5ULCBoYW5kbGVfc2lnaW50KQoKIyBMb2thc2kgcGVueWltcGFuYW4gQVBJIGtleQpBUElfS0VZX0ZJTEUgPSBQYXRoLmhvbWUoKSAvICIudnRfYXBpX2tleSIKCiMgRnVuZ3NpIGNsZWFyCmRlZiBjbGVhcigpOgogICAgb3Muc3lzdGVtKCJjbGVhciIpCiAgICBvcy5zeXN0ZW0oIm5lb2ZldGNoIikKCiMgVmFsaWRhc2kgVVJMCmRlZiBpc192YWxpZF91cmwodXJsKToKICAgIHBhdHRlcm4gPSByJ15odHRwcz86Ly9bYS16QS1aMC05Li1dK1wuW2EtekEtWl17Mix9JwogICAgcmV0dXJuIHJlLm1hdGNoKHBhdHRlcm4sIHVybCkKCiMgQW1iaWwgaW5mb3JtYXNpIHdlYnNpdGUgKFBpbGloYW4gMSkKZGVmIGdldF9pbmZvKHVybCk6CiAgICB0cnk6CiAgICAgICAgZG9tYWluID0gcmUuc3ViKHInXmh0dHBzPzpcL1wvJywgJycsIHVybCkuc3BsaXQoJy8nKVswXQogICAgICAgIGlwID0gc29ja2V0LmdldGhvc3RieW5hbWUoZG9tYWluKQogICAgICAgIHRyeToKICAgICAgICAgICAgaG9zdG5hbWUgPSBzb2NrZXQuZ2V0aG9zdGJ5YWRkcihpcClbMF0KICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIGhvc3RuYW1lID0gIk4vQSIKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldChmImh0dHBzOi8vaXBpbmZvLmlvL3tpcH0vanNvbiIpLmpzb24oKQogICAgICAgIHRyeToKICAgICAgICAgICAgd2hvaXMgPSBJUFdob2lzKGlwKS5sb29rdXBfcmRhcCgpCiAgICAgICAgICAgIG9yZ19uYW1lID0gd2hvaXMuZ2V0KCduZXR3b3JrJywge30pLmdldCgnbmFtZScsICdOL0EnKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgb3JnX25hbWUgPSAiTi9BIgoKICAgICAgICBpbmZvID0gewogICAgICAgICAgICAiVVJMIjogdXJsLAogICAgICAgICAgICAiSVAgQWRkcmVzcyI6IGlwLAogICAgICAgICAgICAiSG9zdCBOYW1lIjogaG9zdG5hbWUsCiAgICAgICAgICAgICJJU1AiOiByZXNwb25zZS5nZXQoJ29yZycsICdOL0EnKSwKICAgICAgICAgICAgIk9yZ2FuaXphdGlvbiI6IG9yZ19uYW1lLAogICAgICAgICAgICAiQ291bnRyeSI6IHJlc3BvbnNlLmdldCgnY291bnRyeScsICdOL0EnKSwKICAgICAgICAgICAgIlJlZ2lvbiI6IHJlc3BvbnNlLmdldCgncmVnaW9uJywgJ04vQScpLAogICAgICAgICAgICAiQ2l0eSI6IHJlc3BvbnNlLmdldCgnY2l0eScsICdOL0EnKSwKICAgICAgICAgICAgIlRpbWV6b25lIjogcmVzcG9uc2UuZ2V0KCd0aW1lem9uZScsICdOL0EnKSwKICAgICAgICAgICAgIkxvY2FsIFRpbWUiOiBkYXRldGltZS5ub3cocHl0ei50aW1lem9uZShyZXNwb25zZS5nZXQoJ3RpbWV6b25lJywgJ1VUQycpKSkuc3RyZnRpbWUoJyVZLSVtLSVkICVIOiVNOiVTJyksCiAgICAgICAgICAgICJQb3N0YWwgQ29kZSI6IHJlc3BvbnNlLmdldCgncG9zdGFsJywgJ04vQScpLAogICAgICAgICAgICAiQ29vcmRpbmF0ZXMiOiByZXNwb25zZS5nZXQoJ2xvYycsICdOL0EnKQogICAgICAgIH0KCiAgICAgICAgcHJpbnQoZiJcbntHUkVFTn17Qk9MRH1XZWJzaXRlIEluZm9ybWF0aW9uOntSRVNFVH0iKQogICAgICAgIGZvciBrZXksIHZhbCBpbiBpbmZvLml0ZW1zKCk6CiAgICAgICAgICAgIHByaW50KGYie0NZQU59e2tleTo8MTV9OntSRVNFVH0ge1lFTExPV317dmFsfXtSRVNFVH0iKQogICAgICAgIHByaW50KCkKCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZiJ7UkVEfUVycm9yOiB7ZX17UkVTRVR9IikKCiMgU2ltcGFuIGRhbiB2YWxpZGFzaSBBUEkga2V5IFZpcnVzVG90YWwKZGVmIGdldF92dF9hcGlfa2V5KCk6CiAgICBpZiBBUElfS0VZX0ZJTEUuZXhpc3RzKCk6CiAgICAgICAgcmV0dXJuIEFQSV9LRVlfRklMRS5yZWFkX3RleHQoKS5zdHJpcCgpCiAgICBlbHNlOgogICAgICAgIHByaW50KGYie1JFRH1bIV0gTm8gVmlydXNUb3RhbCBBUEkga2V5IGZvdW5kLntSRVNFVH0iKQogICAgICAgIHByaW50KGYie0NZQU59VmlzaXQgaHR0cHM6Ly93d3cudmlydXN0b3RhbC5jb20gYW5kIGxvZyBpbiB0byBnZXQgeW91ciBBUEkga2V5LntSRVNFVH0iKQogICAgICAgIGtleSA9IGlucHV0KGYie1lFTExPV31FbnRlciB5b3VyIFZpcnVzVG90YWwgQVBJIGtleToge1JFU0VUfSIpCiAgICAgICAgaWYgdmFsaWRhdGVfdnRfYXBpKGtleSk6CiAgICAgICAgICAgIEFQSV9LRVlfRklMRS53cml0ZV90ZXh0KGtleS5zdHJpcCgpKQogICAgICAgICAgICBwcmludChmIntHUkVFTn1bK10gQVBJIGtleSBzYXZlZCBzdWNjZXNzZnVsbHkue1JFU0VUfSIpCiAgICAgICAgICAgIHJldHVybiBrZXkuc3RyaXAoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KGYie1JFRH1bIV0gSW52YWxpZCBBUEkga2V5LntSRVNFVH0iKQogICAgICAgICAgICByZXR1cm4gTm9uZQoKIyBWYWxpZGFzaSBBUEkga2V5CmRlZiB2YWxpZGF0ZV92dF9hcGkoa2V5KToKICAgIGhlYWRlcnMgPSB7IngtYXBpa2V5Ijoga2V5fQogICAgdHJ5OgogICAgICAgIHIgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vd3d3LnZpcnVzdG90YWwuY29tL2FwaS92My91c2Vycy9tZSIsIGhlYWRlcnM9aGVhZGVycykKICAgICAgICByZXR1cm4gci5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm4gRmFsc2UKCiMgU2NhbiBVUkwgZGVuZ2FuIFZpcnVzVG90YWwgKFBpbGloYW4gMikKZGVmIHNjYW5fdXJsX3dpdGhfdmlydXN0b3RhbCh1cmwsIGtleSk6CiAgICBoZWFkZXJzID0geyJ4LWFwaWtleSI6IGtleX0KICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoImh0dHBzOi8vd3d3LnZpcnVzdG90YWwuY29tL2FwaS92My91cmxzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycz1oZWFkZXJzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhPXsidXJsIjogdXJsfSkKICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSAhPSAyMDA6CiAgICAgICAgICAgIHByaW50KGYie1JFRH1GYWlsZWQgdG8gc3VibWl0IFVSTCB0byBWaXJ1c1RvdGFsLntSRVNFVH0iKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgYW5hbHlzaXNfaWQgPSByZXNwb25zZS5qc29uKClbJ2RhdGEnXVsnaWQnXQogICAgICAgIHRpbWUuc2xlZXAoMikKICAgICAgICBhbmFseXNpc191cmwgPSBmImh0dHBzOi8vd3d3LnZpcnVzdG90YWwuY29tL2FwaS92My9hbmFseXNlcy97YW5hbHlzaXNfaWR9IgogICAgICAgIHJlc3VsdCA9IHJlcXVlc3RzLmdldChhbmFseXNpc191cmwsIGhlYWRlcnM9aGVhZGVycykuanNvbigpCgogICAgICAgIHN0YXRzID0gcmVzdWx0WyJkYXRhIl1bImF0dHJpYnV0ZXMiXVsic3RhdHMiXQogICAgICAgIHByaW50KGYiXG57R1JFRU59U2NhbiBSZXN1bHRzOntSRVNFVH0iKQogICAgICAgIGZvciBrZXkgaW4gc3RhdHM6CiAgICAgICAgICAgIHByaW50KGYie0NZQU59e2tleS5jYXBpdGFsaXplKCk6PDE1fTp7UkVTRVR9IHtZRUxMT1d9e3N0YXRzW2tleV19e1JFU0VUfSIpCgogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYie1JFRH1FcnJvciBzY2FubmluZyBVUkw6IHtlfXtSRVNFVH0iKQoKIyBDZWsgYXBha2FoIHNpdHVzIHNlZGFuZyBvbmxpbmUgKFBpbGloYW4gMykKZGVmIGNoZWNrX3NpdGVfc3RhdHVzKHVybCk6CiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsKQogICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgcHJpbnQoZiJ7R1JFRU59VGhlIHNpdGUgaXMgT05MSU5FIXtSRVNFVH0iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KGYie1JFRH1UaGUgc2l0ZSByZXR1cm5lZCBhIHtyZXNwb25zZS5zdGF0dXNfY29kZX0gZXJyb3IgY29kZS57UkVTRVR9IikKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChmIntSRUR9VGhlIHNpdGUgaXMgT0ZGTElORS4gRXJyb3I6IHtlfXtSRVNFVH0iKQoKIyBUYW1waWxrYW4gc2FsYW0gc2VzdWFpIHdha3R1IGxva2FsCmRlZiBncmVldGluZygpOgogICAgaG91ciA9IGRhdGV0aW1lLm5vdygpLmhvdXIKICAgIGlmIDUgPD0gaG91ciA8IDEyOgogICAgICAgIHJldHVybiAiR29vZCBNb3JuaW5nIgogICAgZWxpZiAxMiA8PSBob3VyIDwgMTY6CiAgICAgICAgcmV0dXJuICJHb29kIEFmdGVybm9vbiIKICAgIGVsaWYgMTYgPD0gaG91ciA8IDIwOgogICAgICAgIHJldHVybiAiR29vZCBFdmVuaW5nIgogICAgZWxzZToKICAgICAgICByZXR1cm4gIkdvb2QgTmlnaHQiCgojIE1lbnUgdXRhbWEKZGVmIG1haW4oKToKICAgIHdoaWxlIFRydWU6CiAgICAgICAgY2xlYXIoKQogICAgICAgIHByaW50KGYie0JMVUV9e0JPTER94pWt4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pWue1JFU0VUfSIpCiAgICAgICAgcHJpbnQoZiJ7QkxVRX3ilIJ7UkVTRVR9IHtZRUxMT1d9e2dyZWV0aW5nKCl9IC0gU2NyaXB0IGJ5IE11bXl6IChSYWZhZWwpe1JFU0VUOjwyOH17QkxVRX3ilIJ7UkVTRVR9IikKICAgICAgICBwcmludChmIntCTFVFfeKVsOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKVr3tSRVNFVH0iKQogICAgICAgIHByaW50KGYie0JMVUV94pSCe1JFU0VUfSB7WUVMTE9XfTB7UkVTRVR9LiBFeGl0IGFuZCBDbGVhciAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge0JMVUV94pSCe1JFU0VUfSIpCiAgICAgICAgcHJpbnQoZiJ7QkxVRX3ilIJ7UkVTRVR9IHtZRUxMT1d9MXtSRVNFVH0uIFdlYnNpdGUgSW5mb3JtYXRpb24gTG9va3VwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7QkxVRX3ilIJ7UkVTRVR9IikKICAgICAgICBwcmludChmIntCTFVFfeKUgntSRVNFVH0ge1lFTExPV30ye1JFU0VUfS4gVmlydXNUb3RhbCBVUkwgU2NhbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtCTFVFfeKUgntSRVNFVH0iKQogICAgICAgIHByaW50KGYie0JMVUV94pSCe1JFU0VUfSB7WUVMTE9XfTN7UkVTRVR9LiBDaGVjayBpZiBTaXRlIGlzIFVwIG9yIERvd24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge0JMVUV94pSCe1JFU0VUfSIpCiAgICAgICAgcHJpbnQoZiJ7QkxVRX3ilbDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDila97UkVTRVR9IikKICAgICAgICBjaG9pY2UgPSBpbnB1dChmIntHUkVFTn1TZWxlY3QgYW4gb3B0aW9uOiB7UkVTRVR9IikKCiAgICAgICAgaWYgY2hvaWNlID09ICIwIjoKICAgICAgICAgICAgY2xlYXIoKQogICAgICAgICAgICBwcmludChmIntDWUFOfUdvb2RieWUhe1JFU0VUfSIpCiAgICAgICAgICAgIHN5cy5leGl0KCkKCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjEiOgogICAgICAgICAgICBjbGVhcigpCiAgICAgICAgICAgIHVybCA9IGlucHV0KGYie0dSRUVOfUVudGVyIHdlYnNpdGUgVVJMIChlLmcuLCBodHRwczovL2V4YW1wbGUuY29tKToge1JFU0VUfSIpCiAgICAgICAgICAgIGlmIG5vdCBpc192YWxpZF91cmwodXJsKToKICAgICAgICAgICAgICAgIHByaW50KGYie1JFRH1JbnZhbGlkIFVSTCBmb3JtYXQuIFRyeSBhZ2Fpbi57UkVTRVR9IikKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGdldF9pbmZvKHVybCkKICAgICAgICAgICAgICAgIGlucHV0KGYie0JMVUV9UHJlc3MgRW50ZXIgdG8gcmV0dXJuIHRvIG1lbnUuLi57UkVTRVR9IikKCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjIiOgogICAgICAgICAgICBjbGVhcigpCiAgICAgICAgICAgIHVybCA9IGlucHV0KGYie0dSRUVOfUVudGVyIFVSTCB0byBzY2FuOiB7UkVTRVR9IikKICAgICAgICAgICAgaWYgbm90IGlzX3ZhbGlkX3VybCh1cmwpOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7UkVEfUludmFsaWQgVVJMIGZvcm1hdC57UkVTRVR9IikKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGtleSA9IGdldF92dF9hcGlfa2V5KCkKICAgICAgICAgICAgICAgIGlmIGtleToKICAgICAgICAgICAgICAgICAgICBzY2FuX3VybF93aXRoX3ZpcnVzdG90YWwodXJsLCBrZXkpCiAgICAgICAgICAgICAgICBpbnB1dChmIntCTFVFfVByZXNzIEVudGVyIHRvIHJldHVybiB0byBtZW51Li4ue1JFU0VUfSIpCgogICAgICAgIGVsaWYgY2hvaWNlID09ICIzIjoKICAgICAgICAgICAgY2xlYXIoKQogICAgICAgICAgICB1cmwgPSBpbnB1dChmIntHUkVFTn1FbnRlciB3ZWJzaXRlIFVSTCB0byBjaGVjayBzdGF0dXM6IHtSRVNFVH0iKQogICAgICAgICAgICBpZiBub3QgaXNfdmFsaWRfdXJsKHVybCk6CiAgICAgICAgICAgICAgICBwcmludChmIntSRUR9SW52YWxpZCBVUkwgZm9ybWF0LntSRVNFVH0iKQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgyKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgY2hlY2tfc2l0ZV9zdGF0dXModXJsKQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgyKQogICAgICAgICAgICAgICAgaW5wdXQoZiJ7QkxVRX1QcmVzcyBFbnRlciB0byByZXR1cm4gdG8gbWVudS4uLntSRVNFVH0iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KGYie1JFRH1JbnZhbGlkIGNob2ljZS4gVHJ5IGFnYWluLntSRVNFVH0iKQogICAgICAgICAgICB0aW1lLnNsZWVwKDIpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigpCg=='))
